<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Waves</title>
</head>
<body>
<h1>Waves</h1>
<div>
  <h2>
    sin
  </h2>
  <canvas id="sin" width="200" height="100">
  </canvas>
</div>
<div>
  <h2>
    triangle
  </h2>
  <canvas id="triangle" width="200" height="100">
  </canvas>
</div>
<div>
  <h2>
    saw
  </h2>
  <canvas id="saw" width="200" height="100">
  </canvas>
</div>

<div>
  <h2>
    square
  </h2>
  <canvas id="square" width="200" height="100">
  </canvas>
</div>
<script>
  // https://github.com/netcell/FTrig
  const sinLow = x => {
    x = x % (2 * 3.14159265) - 3.14159265;
    if (x < -3.14159265) x += 6.28318531;
    else if (x > 3.14159265) x -= 6.28318531;
    if (x < 0) return 1.27323954 * x + .405284735 * x * x;
    else return 1.27323954 * x - 0.405284735 * x * x;
  };

  const saw = (f, phi, t) => {
    return Math.abs(t * 2 * f + phi) % 2 - 1
  };

  const pulse = (width) => (f, phi, t) => {
    const cutoff = 1 - 2 * width;
    return saw(f, phi, t) > cutoff ? 1 : -1;
  };

  const square = pulse(0.5);

  const sin = (f, phi, t) => {
    return sinLow(2 * Math.PI * f * t + 2 * Math.PI * phi)
  };

  const triangle = (f, phi, t) => {
    return 2 * Math.abs(saw(f, phi + 0.5, t)) - 1
  };

  // --- draw wave ---

  const drawWave = (wave, canvas) => {
    const ctx = canvas.getContext('2d');

    const canvasWidth = 200;
    const canvasHeight = 100;
    const canvasVerticalMargin = 10;
    const resolution = 100;
    const tickSize = 10;

    ctx.strokeStyle = 'rgba(0,0,0,0.5)'
    ctx.beginPath();
    ctx.moveTo(0, canvasHeight / 2)
    ctx.lineTo(canvasWidth, canvasHeight / 2);
    ctx.stroke();

    ctx.beginPath()
    ctx.moveTo(canvasWidth/2, canvasHeight /2 - tickSize/2);
    ctx.lineTo(canvasWidth/2, canvasHeight /2 + tickSize/2);
    ctx.stroke();

    ctx.beginPath()
    ctx.moveTo(0, canvasHeight /2 - tickSize/2);
    ctx.lineTo(0, canvasHeight /2 + tickSize/2);
    ctx.stroke();

    ctx.beginPath()
    ctx.moveTo(canvasWidth, canvasHeight /2 - tickSize/2);
    ctx.lineTo(canvasWidth, canvasHeight /2 + tickSize/2);
    ctx.stroke();

    ctx.strokeStyle = 'rgba(0,0,0,1)'
    ctx.beginPath();

    for (let i = 0; i <= resolution; i++) {
      const t = i / resolution;
      const value = wave(1, 0, t);
      const x = t * canvasWidth;
      const y = (value + 1) / 2 * (canvasHeight - 2 * canvasVerticalMargin) + canvasVerticalMargin;

      if (i === 0) {
        ctx.moveTo(x, y)
      } else {
        ctx.lineTo(x, y)
      }
    }

    ctx.stroke()
  }

  drawWave(sin, document.getElementById('sin'))
  drawWave(triangle, document.getElementById('triangle'))
  drawWave(saw, document.getElementById('saw'))
  drawWave(square, document.getElementById('square'))
</script>
</body>
</html>